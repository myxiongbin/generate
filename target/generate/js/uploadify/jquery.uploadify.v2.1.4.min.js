if(jQuery){(function(b){b.extend(b.fn,{uploadify:function(a){b(this).each(function(){var k=b.extend({id:b(this).attr("id"),uploader:"uploadify.swf",script:"uploadify.php",expressInstall:null,folder:"",height:30,width:120,cancelImg:"cancel.png",wmode:"opaque",scriptAccess:"sameDomain",fileDataName:"Filedata",method:"POST",queueSizeLimit:999,simUploadLimit:1,queueID:false,displayData:"percentage",removeCompleted:true,onInit:function(){},onSelect:function(){},onSelectOnce:function(){},onQueueFull:function(){},onCheck:function(){},onCancel:function(){},onClearQueue:function(){},onError:function(){},onProgress:function(){},onComplete:function(){},onAllComplete:function(){}},a);b(this).data("settings",k);var l=location.pathname;l=l.split("/");l.pop();l=l.join("/")+"/";var j={};j.uploadifyID=k.id;j.pagepath=l;if(k.buttonImg){j.buttonImg=escape(k.buttonImg)}if(k.buttonText){j.buttonText=encodeURI(k.buttonText)}if(k.rollover){j.rollover=true}j.script=k.script;j.folder=escape(k.folder);if(k.scriptData){var i="";for(var m in k.scriptData){i+="&"+m+"="+k.scriptData[m]}j.scriptData=escape(i.substr(1))}j.width=k.width;j.height=k.height;j.wmode=k.wmode;j.method=k.method;j.queueSizeLimit=k.queueSizeLimit;j.simUploadLimit=k.simUploadLimit;if(k.hideButton){j.hideButton=true}if(k.fileDesc){j.fileDesc=k.fileDesc}if(k.fileExt){j.fileExt=k.fileExt}if(k.multi){j.multi=true}if(k.auto){j.auto=true}if(k.sizeLimit){j.sizeLimit=k.sizeLimit}if(k.checkScript){j.checkScript=k.checkScript}if(k.fileDataName){j.fileDataName=k.fileDataName}if(k.queueID){j.queueID=k.queueID}if(k.onInit()!==false){b(this).css("display","none");b(this).after('<div id="'+b(this).attr("id")+'Uploader"></div>');swfobject.embedSWF(k.uploader,k.id+"Uploader",k.width,k.height,"9.0.24",k.expressInstall,j,{quality:"high",wmode:k.wmode,allowScriptAccess:k.scriptAccess},{},function(c){if(typeof(k.onSWFReady)=="function"&&c.success){k.onSWFReady()}});if(k.queueID==false){b("#"+b(this).attr("id")+"Uploader").after('<div id="'+b(this).attr("id")+'Queue" class="uploadifyQueue"></div>')}else{b("#"+k.queueID).addClass("uploadifyQueue")}}if(typeof(k.onOpen)=="function"){b(this).bind("uploadifyOpen",k.onOpen)}b(this).bind("uploadifySelect",{action:k.onSelect,queueID:k.queueID},function(e,g,f){if(e.data.action(e,g,f)!==false){var d=Math.round(f.size/1024*100)*0.01;var c="KB";if(d>1000){d=Math.round(d*0.001*100)*0.01;c="MB"}var h=d.toString().split(".");if(h.length>1){d=h[0]+"."+h[1].substr(0,2)}else{d=h[0]}if(f.name.length>20){name=f.name.substr(0,20)+"..."}else{name=f.name}queue="#"+b(this).attr("id")+"Queue";if(e.data.queueID){queue="#"+e.data.queueID}b(queue).append('<div id="'+b(this).attr("id")+g+'" class="uploadifyQueueItem"><div class="cancel"><a href="javascript:jQuery(\'#'+b(this).attr("id")+"').uploadifyCancel('"+g+'\')"><img src="'+k.cancelImg+'" border="0" /></a></div><span class="fileName">'+name+" ("+d+c+')</span><span class="percentage"></span><div class="uploadifyProgress"><div id="'+b(this).attr("id")+g+'ProgressBar" class="uploadifyProgressBar"><!--Progress Bar--></div></div></div>')}});b(this).bind("uploadifySelectOnce",{action:k.onSelectOnce},function(d,c){d.data.action(d,c);if(k.auto){if(k.checkScript){b(this).uploadifyUpload(null,false)}else{b(this).uploadifyUpload(null,true)}}});b(this).bind("uploadifyQueueFull",{action:k.onQueueFull},function(d,c){if(d.data.action(d,c)!==false){alert("The queue is full.  The max size is "+c+".")}});b(this).bind("uploadifyCheckExist",{action:k.onCheck},function(r,c,d,e,h){var f=new Object();f=d;f.folder=(e.substr(0,1)=="/")?e:l+e;if(h){for(var g in d){var q=g}}b.post(c,f,function(o){for(var t in o){if(r.data.action(r,o,t)!==false){var p=confirm("Do you want to replace the file "+o[t]+"?");if(!p){document.getElementById(b(r.target).attr("id")+"Uploader").cancelFileUpload(t,true,true)}}}if(h){document.getElementById(b(r.target).attr("id")+"Uploader").startFileUpload(q,true)}else{document.getElementById(b(r.target).attr("id")+"Uploader").startFileUpload(null,true)}},"json")});b(this).bind("uploadifyCancel",{action:k.onCancel},function(p,f,c,h,g,d){if(p.data.action(p,f,c,h,d)!==false){if(g){var e=(d==true)?0:250;b("#"+b(this).attr("id")+f).fadeOut(e,function(){b(this).remove()})}}});b(this).bind("uploadifyClearQueue",{action:k.onClearQueue},function(c,d){var e=(k.queueID)?k.queueID:b(this).attr("id")+"Queue";if(d){b("#"+e).find(".uploadifyQueueItem").remove()}if(c.data.action(c,d)!==false){b("#"+e).find(".uploadifyQueueItem").each(function(){var f=b(".uploadifyQueueItem").index(this);b(this).delay(f*100).fadeOut(250,function(){b(this).remove()})})}});var n=[];b(this).bind("uploadifyError",{action:k.onError},function(c,g,d,e){if(c.data.action(c,g,d,e)!==false){var f=new Array(g,d,e);n.push(f);b("#"+b(this).attr("id")+g).find(".percentage").text(" - "+e.type+" Error");b("#"+b(this).attr("id")+g).find(".uploadifyProgress").hide();b("#"+b(this).attr("id")+g).addClass("uploadifyError")}});if(typeof(k.onUpload)=="function"){b(this).bind("uploadifyUpload",k.onUpload)}b(this).bind("uploadifyProgress",{action:k.onProgress,toDisplay:k.displayData},function(d,f,e,c){if(d.data.action(d,f,e,c)!==false){b("#"+b(this).attr("id")+f+"ProgressBar").animate({width:c.percentage+"%"},250,function(){if(c.percentage==100){b(this).closest(".uploadifyProgress").fadeOut(250,function(){b(this).remove()})}});if(d.data.toDisplay=="percentage"){displayData=" - "+c.percentage+"%"}if(d.data.toDisplay=="speed"){displayData=" - "+c.speed+"KB/s"}if(d.data.toDisplay==null){displayData=" "}b("#"+b(this).attr("id")+f).find(".percentage").text(displayData)}});b(this).bind("uploadifyComplete",{action:k.onComplete},function(d,g,e,f,c){if(d.data.action(d,g,e,unescape(f),c)!==false){b("#"+b(this).attr("id")+g).find(".percentage").text(" - Completed");if(k.removeCompleted){b("#"+b(d.target).attr("id")+g).fadeOut(250,function(){b(this).remove()})}b("#"+b(d.target).attr("id")+g).addClass("completed")}});if(typeof(k.onAllComplete)=="function"){b(this).bind("uploadifyAllComplete",{action:k.onAllComplete},function(d,c){if(d.data.action(d,c)!==false){n=[]}})}})},uploadifySettings:function(m,i,p){var l=false;b(this).each(function(){if(m=="scriptData"&&i!=null){if(p){var e=i}else{var e=b.extend(b(this).data("settings").scriptData,i)}var c="";for(var d in e){c+="&"+d+"="+e[d]}i=escape(c.substr(1))}l=document.getElementById(b(this).attr("id")+"Uploader").updateSettings(m,i)});if(i==null){if(m=="scriptData"){var a=unescape(l).split("&");var n=new Object();for(var o=0;o<a.length;o++){var k=a[o].split("=");n[k[0]]=k[1]}l=n}}return l},uploadifyUpload:function(a,d){b(this).each(function(){if(!d){d=false}document.getElementById(b(this).attr("id")+"Uploader").startFileUpload(a,d)})},uploadifyCancel:function(a){b(this).each(function(){document.getElementById(b(this).attr("id")+"Uploader").cancelFileUpload(a,true,true,false)})},uploadifyClearQueue:function(){b(this).each(function(){document.getElementById(b(this).attr("id")+"Uploader").clearFileUploadQueue(false)})}})})(jQuery)};